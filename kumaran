pipeline {
    agent any
    stages {
        stage ('git pull') {
          steps{
            sshagent(credentials : ['azure-cred']) {
              sh '''#!/bin/bash
                 ssh -o StrictHostKeyChecking=no azureuser@20.212.226.181 << EOF
                 sudo su - odoo
                 git pull "https://purusothamans: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@github.com/ajoebert/odoo_dev.git"
                 sudo service odoo15 restart
                 sudo service fastapi restart
                 sudo service postgresql restart
                 <<EOF'''
                }
            }
        }
        stage ('service restart') {
          steps{
            sshagent(credentials : ['azure-cred']) {
              sh '''#!/bin/bash
                 ssh -o StrictHostKeyChecking=no azureuser@20.212.226.181 << EOF
                 sudo service odoo15 restart
                 sudo service fastapi restart
                 sudo service postgresql restart
                 <<EOF'''
                }
            }
        }
    }
}
